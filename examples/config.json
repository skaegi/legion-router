{
  "version": "1.0",
  "rules": [
    {
      "name": "block-metadata-service",
      "action": "deny",
      "order": 10,
      "egress": {
        "ips": ["169.254.169.254"]
      }
    },
    {
      "name": "allow-dns",
      "action": "allow",
      "order": 50,
      "egress": {
        "protocols": ["udp", "tcp"],
        "ports": ["53"]
      }
    },
    {
      "name": "allow-ssh",
      "action": "allow",
      "order": 50,
      "egress": {
        "protocols": ["tcp"],
        "ports": ["22"]
      }
    },
    {
      "name": "allow-github",
      "action": "allow",
      "order": 100,
      "egress": {
        "protocols": ["tcp"],
        "domains": ["github.com", "api.github.com", "*.github.com"],
        "ports": ["443", "22"]
      }
    },
    {
      "name": "allow-npm",
      "action": "allow",
      "order": 100,
      "egress": {
        "protocols": ["tcp"],
        "domains": ["registry.npmjs.org"],
        "ports": ["443"]
      }
    },
    {
      "name": "allow-anthropic",
      "action": "allow",
      "order": 100,
      "egress": {
        "protocols": ["tcp"],
        "domains": ["api.anthropic.com", "statsig.anthropic.com"],
        "ports": ["443"]
      }
    },
    {
      "name": "allow-icmp",
      "action": "allow",
      "order": 300,
      "egress": {
        "protocols": ["icmp"]
      }
    }
  ]
}
